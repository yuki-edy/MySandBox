# プログラム品質規約

##　目的
プログラムとしての品質を測定可能にする
※最終的にはCI(continuous integration)に落とし込みたい。

## 1. 可読性(Readability)
- ネスト深さ3段以内
- 1ファイルの行数xx以内
- 異なるレイヤーを同一ファイルに混在させない

## 2. 命名品質(Naming)
- 単文字変数はループカウンタとしてしか使用しない
- booleanを返す関数の関数名は(is/has/can/should)で始める
  例）isMeshGenerated
- 否定系命名は禁止
  例）hasNoError 
- 名前から役割が推測可能であること
- スコープが広い変数の名前は具体的にする

## 3. 構造品質(Structure)
- 1関数の行数xx以内
- グローバル変数は使用禁止
- 引数は5個以内に収めること
- 関数の外で値を書き換えないこと
- 1つのクラスには1つの責務のみを与えること（クラスの責務を一文で説明できない場合は分割する）

## 4. エラーハンドリング品質
- エラーの対象(ユーザー向け/開発者向け/システムエラー)を区別すること
- 状態・原因・対処を含めること
- 数値入力では入力値も含めること
- catchでの握りつぶしは禁止
- catchを使用する場合は、
  - なぜ失敗したのかをログで返す。
  - 例外を再生成・再スローする。
  - 業務的に意味のある代替処理
  のいずれかで対応する。
- その関数内で判断できない場合は、catch無しthrowを使用する。
- UI/API/バッチ入口でのみユーザー向けに例外を変換すること

## 5. ログ品質
- printf残留の禁止
  - デバッグ目的の標準出力（printf / print / println / console.log）の残留を禁止する
  - 出力が必要な場合はログフレームワーク(loggerなど)を使用すること
  - テストコードを除き、標準出力の使用は禁止
    (秘密情報、不要なバグ、必要性の再判断などにつながるため禁止)
- ループ内でのログ出力は原則禁止する
- INFOログは業務イベントに限定し、DEBUGログは内部での調査目的に限定する
- TODOコメントには理由を必須とする
   
## 6. テスト品質
- public関数には単体テストをそれぞれ容易すること
- 数値計算に対して誤差許容度をテストすること

## 7. コメント品質
- 関数・公開メソッドには意図（Why）を説明するコメントを記載すること
- 関数の入力が前提としている前提条件を明示すること
- 入力が不正の場合は不正時をふるまいを書くこと
- ドメイン用語の意味はコメントにて定義すること
- コメントと実装が矛盾した場合、コメントを修正または削除すること

## 8. 変更容易性
- 仕様変更が発生した場合、修正箇所が限定される構造であること
- 変更理由を説明できない修正は禁止
